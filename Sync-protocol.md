<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
</head>
<body>

# بروتوكول AXON: النظرة العامة والميزات

### **1. مقدمة: لماذا AXON؟**
جاء اختراع بروتوكول **AXON** لسد فجوة تقنية عميقة؛ وهي عدم توفر "نقطة انطلاق موحدة" تجمع بين كفاءة الأنظمة المحلية وقوة الأنظمة السحابية والتعاونية. المطور اليوم يجد نفسه في حيرة عند محاولة بناء الأنظمة، خاصة في كيفية بناء طبقة الاستمرارية (Persistence) مع تقنيات الـ P2P. يوفر **AXON** هذا المسار الموحد، مما يسمح للمطور بالتركيز على بناء الميزات بدلاً من الغرق في تفاصيل الربط بين المصادر.

---

### **2. الميزات: التقاء المحاور (The Convergence)**
يعمل بروتوكول **AXON** كجسر ينهي الصراع بين عدة أقطاب تقنية كانت تُعتبر سابقاً جزرًا منعزلة:

* **الأداء المحلي (Local-First):** يمنح القدرة على التعامل مع البيانات ومعالجتها محلياً بسرعة فائقة، مما يجعل النظام يستجيب فوراً لتفاعلات المستخدم.
* **الاستمرارية وترتيب الأحداث (Offline-First):** يضمن بقاء النظام فعالاً عند انقطاع الاتصال؛ حيث يقوم الممثل بمعالجة البيانات وترتيب الأحداث زمنياً ومنطقياً، ويضمن تماثلها مع العالم الخارجي فور توفر الاتصال.
* **التعاون اللحظي (Collaborative):** يدعم القدرة على العمل الجماعي اللحظي بين عدة ممثلين (Actors) عبر قنوات الأقران (A2A)، مما يوفر تجربة تعاونية سلسة.
* **تمكين الـ Serverless و Passive Cloud:** لا يفرض البروتوكول بنية تحتية معينة؛ بل يمنح حرية الاعتماد الكامل على قنوات الأقران (بما يحقق مفهوم الـ Serverless الحقيقي) أو الاعتماد على المصادر السحابية كمخازن خاملة (Passive Cloud)، أو الجمع بينهما.
* **الخصوصية وسيادة البيانات (Privacy):** البيانات ملك للمستخدم بالكامل. الممثل (Actor) هو المتحكم الوحيد في مسار بياناته، مكان تخزين نسخته الأولى، وكيفية تشفيرها.

---

### **3. الملخص التقني للبروتوكول (Technical Protocol Abstract)**

بروتوكول **AXON** هو معيار لتنسيق البيانات بين **النسخة المتماثلة (Replica)** و**المصادر المتعددة (Multi-Sources)**، يرتكز على دور **الممثل (Actor)** كمدير مستقل للنسخ المتماثلة. يتميز البروتوكول بالآليات التالية:

* **هيكلية بيانات موحدة ومحايدة:** صُمم البروتوكول ليعمل فوق هيكل بيانات مبسط يتكون من (**List, Item, Field**). هذا التصميم يجعله محايداً تماماً تجاه الأنواع التقليدية لقواعد البيانات (مثل SQL و NoSQL)؛ حيث يتم تمثيل أي نوع بيانات ضمن هذا الهيكل المرن والموحد.
* **ثنائية التنسيق:** ينظم البروتوكول العلاقة بين **النسخة الأولى (First Replica)** كمرجع سيادي موثوق ودائم التوافر، وبين **المصادر البعيدة (Remote Sources)** بمختلف أنواعها.
* **كفاءة وموثوقية المزامنة:** يعتمد البروتوكول على خوارزميات محكمة ودقيقة وفائقة الفعالية، خالية من العشوائية وموافقة للمنطق تماماً.
    * يتم مزامنة النسخ بالاعتماد على **نقاط تفتيش دقيقة ومنطقية** تضمن الكفاءة القصوى.
    * يمتلك البروتوكول نظاماً صارماً لـ **حل التعارض وضمان ترتيب الأحداث**، مما يوفر تماثلاً كاملاً في جميع النسخ.
    * **الحذف القطعي والتطهير:** الحذف في البروتوكول يعني الحذف النهائي؛ فلا مجال لوجود بيانات لا فائدة منها. يتم تتبع آثار الحذف بدقة متناهية لضمان تماثل ونظافة كافة النسخ المتماثلة عبر جميع المصادر.
* **الحياد الهيكلي للشبكة:** يوفر قواعد مرنة تسمح بالعمل عبر مسارات متنوعة (P2P، Cloud، أو Hybrid).
* **استقلالية الوسيط:** يركز البروتوكول على "منطق حركة البيانات" بين النسخ وتوقيتها، مما يجعله قابلاً للعمل فوق أي وسيط تخزين أو تقنية نقل.




# مصادر الممثل (Actor Sources)

في بروتوكول **AXON**، يمثل الممثل (Actor) المنسق الذكي الذي يدير تدفق البيانات بين مستويين أساسيين من المصادر لضمان استمرارية العمل وتماثل الحالة.

---

## 1. النسخة الأولى (First Replica)
تُعرف بأنها المصدر الأول والموثوق، وهي الركيزة الأساسية التي تضمن استمرارية عمل النظام تحت أي ظرف.

* **التوافر المطلق (Always Available):** صُممت هذه النسخة لتكون متاحة للممثل في جميع الظروف؛ بحيث لا يتوقف الممثل عن أداء مهامه، معالجة البيانات، أو تنفيذ عمليات CRUD حتى في حالة الانقطاع الكامل لكافة مصادر الشبكة (Network Sources).
* **استقلالية المعالجة:** يعمل الممثل على هذه النسخة بشكل أصيل، مما يضمن عدم وجود نقطة فشل واحدة (Single Point of Failure) تعيق أداء النظام.
* **مسؤولية التماثل:** يقع على عاتق الممثل مسؤولية إدارة هذه النسخة وضمان تماثلها (Synchronization) مع المصادر الأخرى فور توفرها.
* **مرونة التموضع:** لا يفرض البروتوكول أن تكون النسخة محلية؛ بل يمكن أن يمتلك الممثل الحرية الكاملة في تحديد موقع استضافتها (سواء كانت محلية أو في بيئة خاصة) بشرط تحقيق معيار التوافر الدائم الخاص بالممثل.

---

## 2. مصادر الشبكة (Network Sources)
هي القنوات التي تسمح بتبادل البيانات والضمان لاتساقها بين جميع الممثلين.

### 2.1 النسخة السحابية (Cloud Replica)
طبقة مرجعية واستمرارية (Persistence) عامة تخدم جميع الممثلين.
* **المرجعية والاستمرارية:** تضمن وجود نسخة الحقيقة العامة وبقاء البيانات متاحة بشكل دائم.
* **منطق القراءة والكتابة:** يستمر جميع الممثلين بالكتابة عليها، ولكن القراءة تكون من خلال النقطة التفتيشية.
* **قاعدة التحقق (Checkpoint Rule):** الممثل لا يقوم بجلب أي تغييرات من السحابة إلا بعد التحقق من آخر نقطة تفتيش لديه.
    * **ملاحظة:** نقطة التفتيش هي رقم تسلسلي لتتبع عمليات الإضافة والتعديل على البيانات.
    * **المعادلة:** <div class="equation">Get all data has write_seq > actor_cp_seq</div>

### 2.2 قناة الأقران (Actors P2P Channel - A2A)
بوابة نقل مباشر بين الممثلين توفر قناة نقل سريعة دون وسيط تخزيني، وتنقسم إلى:
* **نوع عام (Global):** لجميع الممثلين المسجلين في النظام لتبادل النبضات والتغييرات.
* **مجموعات الممثلين (Group Actors):** نوع خاص لمجموعة محددة من الممثلين، وينتخبون قائداً (Leader Election) يتولى مسؤولية الربط وتحقيق الاستمرارية مع المصادر العامة نيابة عن مجموعته.

---

## 3. المصادر الهجينة (Hybrid Mode)
تكامل المصادر لتحقيق المرونة القصوى في المزامنة:
* **المرونة:** يتطلب البروتوكول توفر نوع واحد على الأقل من مصادر الشبكة، والجمع بينهما اختياري.
* **تكامل الأدوار:** تعمل **Cloud Replica** كطبقة استمرارية عامة ومرجع للممثلين الذين فاتهم التفاعل المباشر الذي تم عبر جلسات الـ **Actors P2P Channel**.
* **كفاءة التماثل:** عند استلام الممثل للبيانات من أي مصدر، يتم تحديث الحالة المرجعية محلياً، مما يضمن أن عمليات الجلب (Pull) اللاحقة من السحابة تكون فعالة ولا تستعيد إلا البيانات المفقودة حقاً.




# هيكلية البيانات في بروتوكول AXON

تعتمد النسخة المتماثلة (**The Replica**) في بروتوكول AXON على هيكل بيانات موحد، محايد، ومنطقي تماماً، يفرض سيادته على أي وسيط تخزين (SQL, NoSQL, etc).

### **1. وحدات البناء الأساسية**
يتم تمثيل كافة البيانات وفق التراتبية التالية:
* **List**: تمثل الوعاء (Collection / Table).
* **Item**: تمثل الوحدة البنائية (Document / Row).
* **Field**: تمثل القيم والمفاتيح (Key-Value / Column).

---

### **2. البيانات الوصفية الإجبارية (Item Metadata)**
لضمان اتساق النسخ المتماثلة في الأنظمة الموزعة، يفرض البروتوكول وجود الحقول التالية في كل **Item**:
* `id`: المعرف الفريد للعنصر.
* `w_cp_seq`: الرقم التسلسلي لنقطة تفتيش الكتابة (Write Checkpoint Sequence).
* `updatedAt`: الطابع الزمني لآخر تحديث لضمان ترتيب الأحداث.

---

### **3. استراتيجية "المصادر المتجانسة" (Meta Lists)**
يعالج البروتوكول إدارة نفسه بنفسه من خلال اعتبار "قوائم البيانات الوصفية" قوائم عادية داخل النسخة المتماثلة، وهو ما يحقق ثلاثة أهداف بآن واحد:

#### **أولاً: قائمة القوائم (Meta List)**
يتم تتبع حالة جميع القوائم في النسخة عبر قائمة وصفية، حيث يكون كل عنصر فيها (`Item`) يمثل قائمة موجودة فعلياً:
* `id`: اسم القائمة (List Name).
* `w_cp_seq`: نقطة تفتيش الكتابة الخاصة بالقائمة ككل.
* `actors_counter`: عداد الممثلين النشطين في هذه القائمة.
* `length`: العدد الفعلي للعناصر لضمان مطابقة النسخ.

#### **ثانياً: تتبع الحذف والتطهير (Tombstone List)**
الحذف في AXON ليس مجرد إخفاء للبيانات، بل هو عملية تتبع دقيقة تضمن "نظافة" كافة النسخ. يتم تتبع العناصر المحذوفة عبر قائمة `Tombstone` تحتوي على:
* `id`: معرف العنصر المحذوف.
* `capture_actors_counter`: عدد الممثلين الذين عاصروا وجود العنصر لحظة حذفه.
* `received_actors_counter`: عدد الممثلين الذين أكدوا استلام خبر الحذف.

> **مبدأ التطهير:** بمجرد تساوي العدادين (`capture` و `received`) لدى الممثل، يتم حذف أثر الـ Tombstone نهائياً من كافة النسخ، مما يضمن عدم بقاء أي بيانات لا فائدة منها.

---

### **4. الملخص التقني المحدث**

بروتوكول **AXON** هو معيار لتنسيق البيانات بين **النسخة المتماثلة (Replica)** و**المصادر المتعددة (Multi-Sources)**، حيث:
1. يرتكز على دور **الممثل (Actor)** كمدير مستقل.
2. يستخدم **خوارزميات محكمة** تعتمد على نقاط تفتيش دقيق لتبادل الفوارق (Deltas).
3. يضمن **حل التعارض** وترتيب الأحداث منطقياً.
4. يفرض **تطهيراً فورياً** للبيانات الميتة لضمان تماثل ونظافة النسخ.




# نقاط تفتيش المزامنة (Sync Checkpoints)

يعتمد بروتوكول AXON على نظام عدادات منطقية (Logical Clocks) تضمن تدفق التغييرات بين الممثلين دون الحاجة إلى التنسيق اللحظي أو التعقيد في إدارة المعرفات الفريدة للزمن.

---

### **1. هيكلية العدادات المزدوجة في Meta**

داخل كل قائمة، يتم الفصل بين زمنين مختلفين تماماً:

* **`since` (عداد البيانات):** يزداد عند أي إضافة أو تعديل للعناصر (`Add/Update Item`). هو المحرك لمزامنة المحتوى.
* **`checkpoint_since` (عداد الهيكل):** هو العداد الشامل للـ Meta. يزداد عند أي تغيير في القائمة (إضافة/إزالة ممثل، أو تحديث الـ `since` نفسه). هو المحرك لمزامنة "الحالة الإدارية".

---

### **2. واقعية التوازي (Concurrency Pulse)**

هذا هو جوهر الفكرة: في البيئات الموزعة، التوازي حتمي وليس خطأ.
* **تعدد المصادر:** إذا قام **Actor A** و **Actor B** بتعديل القائمة في نفس اللحظة (كلاهما يقرأ 50)، فسينتجان كلاهما الرقم **51**.
* **مبدأ العتبة:** نظام نقاط التفتيش في AXON لا يطلب "الرقم التالي"، بل يطلب "كل ما هو أكبر من".
* عندما يطلب الممثل الثالث التحديثات بشرط `since > 50`؛ سيستلم آلياً جميع العمليات التي تحمل الرقم **51** ككتلة واحدة (Batch).



---

### **3. حالة الانعزال والتسوية (Isolation & Settlement)**

عندما تعمل نسخة بشكل منفرد (Offline)، تتوقف نقاط التفتيش عن كونها "مرجعاً عالمياً" وتتحول إلى حالة **الخمول**:
* **خمول نقاط التفتيش:** التغييرات المحلية أثناء الانعزال لا تفرض ترتيباً على العالم الخارجي.
* **التسوية (Settlement):** بمجرد عودة الاتصال، يتم مقارنة حالة النسخة بالعالم. إذا وجد الممثل أن العداد العالمي وصل لـ 100 وهو ما زال عند 50، يقوم بإعادة وسم عملياته المحلية لتبدأ من 101 صعوداً.

---

### **4. تنويهات ختامية**

* **لا علاقة للحذف بالـ since:** الحذف هو عملية إزالة نهائية من القائمة، ولا يستهلك نبضات من عداد الـ `since`. المسؤولية هنا تنتقل لنظام **Tombstone** الذي يعمل في مسار مستقل.
* **المؤشرات (Cursors):** كل ممثل يحفظ `data_cursor` و `meta_cursor` ليعرف أين يقف بالنسبة لهذه النبضات، مما يمنعه من إعادة معالجة نفس البيانات مرتين.




</body>
</html>
